{"version":3,"sources":["../node_modules/reactstrap/es/FormText.js","pages/ImportTrucksPage.js"],"names":["_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_2__","react__WEBPACK_IMPORTED_MODULE_2___default","n","prop_types__WEBPACK_IMPORTED_MODULE_3__","prop_types__WEBPACK_IMPORTED_MODULE_3___default","classnames__WEBPACK_IMPORTED_MODULE_4__","classnames__WEBPACK_IMPORTED_MODULE_4___default","_utils__WEBPACK_IMPORTED_MODULE_5__","propTypes","children","a","node","inline","bool","tag","color","string","className","cssModule","object","FormText","props","Tag","attributes","Object","classes","createElement","defaultProps","__webpack_exports__","ImportTrucksPage","_this","_Users_softbucketio_projects_iTruck_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","_Users_softbucketio_projects_iTruck_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_Users_softbucketio_projects_iTruck_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","call","rerenderParentCallback","findTrucks","state","xtoken","then","response","setState","_Users_softbucketio_projects_iTruck_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","data","catch","respError","handleFileInput","event","v","target","files","file","handleSaveChanges","formData","FormData","append","importTrucks","status","msg","message","error","forceUpdate","console","log","downloadFile","csvFileInput","React","createRef","AsyncStorage","getItem","conf","secret","results","obje_results","JSON","parse","user","token","_this2","options","filter","selectableRows","selectableRowsOnClick","filterType","responsive","draggableColumns","enabled","rowsPerPage","selectToolbarPlacement","customToolbarSelect","selectedRows","displayData","setSelectedRows","react__WEBPACK_IMPORTED_MODULE_7___default","_components_CustomToolbarSelectTrucks__WEBPACK_IMPORTED_MODULE_24__","originalData","Xtoken","downloadOptions","filename","separator","filterOptions","useDisplayedColumnsOnly","useDisplayedRowsOnly","onDownload","buildHead","buildBody","columns","data2","concat","trim","onRowSelectionChange","currentRowsSelected","allRows","rowsSelected","onRowsDelete","rowsDeleted","onChangePage","numberRows","onSearchChange","searchText","onColumnSortChange","column","direction","onViewColumnsChange","action","onFilterChange","filters","onCellClick","cellIndex","rowIndex","onRowClick","rowData","rowState","components_Page__WEBPACK_IMPORTED_MODULE_6__","title","breadcrumbs","name","active","reactstrap__WEBPACK_IMPORTED_MODULE_8__","reactstrap__WEBPACK_IMPORTED_MODULE_9__","xl","lg","md","reactstrap__WEBPACK_IMPORTED_MODULE_10__","reactstrap__WEBPACK_IMPORTED_MODULE_11__","length","reactstrap__WEBPACK_IMPORTED_MODULE_12__","reactstrap__WEBPACK_IMPORTED_MODULE_13__","reactstrap__WEBPACK_IMPORTED_MODULE_14__","reactstrap__WEBPACK_IMPORTED_MODULE_15__","reactstrap__WEBPACK_IMPORTED_MODULE_16__","for","reactstrap__WEBPACK_IMPORTED_MODULE_17__","ref","onChange","type","reactstrap__WEBPACK_IMPORTED_MODULE_18__","check","row","sm","size","offset","reactstrap__WEBPACK_IMPORTED_MODULE_19__","onClick","mui_datatables__WEBPACK_IMPORTED_MODULE_23___default","map","item","id","owner","number","company","make","vin","display","Component"],"mappings":"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","file":"static/js/40.e83be6cd.chunk.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { mapToCssModules, tagPropType } from './utils';\nvar propTypes = {\n  children: PropTypes.node,\n  inline: PropTypes.bool,\n  tag: tagPropType,\n  color: PropTypes.string,\n  className: PropTypes.string,\n  cssModule: PropTypes.object\n};\nvar defaultProps = {\n  tag: 'small',\n  color: 'muted'\n};\n\nvar FormText = function FormText(props) {\n  var className = props.className,\n      cssModule = props.cssModule,\n      inline = props.inline,\n      color = props.color,\n      Tag = props.tag,\n      attributes = _objectWithoutPropertiesLoose(props, [\"className\", \"cssModule\", \"inline\", \"color\", \"tag\"]);\n\n  var classes = mapToCssModules(classNames(className, !inline ? 'form-text' : false, color ? \"text-\" + color : false), cssModule);\n  return React.createElement(Tag, _extends({}, attributes, {\n    className: classes\n  }));\n};\n\nFormText.propTypes = propTypes;\nFormText.defaultProps = defaultProps;\nexport default FormText;","import Page from 'components/Page';\nimport React from 'react';\nimport {\n  Button,\n  Card,\n  CardBody,\n  CardHeader,\n  Col,\n  Form,\n  FormFeedback,\n  FormGroup,\n  FormText,\n  Input,\n  Label,\n  Row,\n  Alert,\n} from 'reactstrap';\nimport { importTrucks, findTrucks} from \"../api/api\";\nimport AsyncStorage from '@callstack/async-storage';\nimport conf from \"../api/config\";\nimport MUIDataTable from \"mui-datatables\";\nimport CustomToolbarSelectTrucks from \"../components/CustomToolbarSelectTrucks\";\nclass ImportTrucksPage extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n          file : '',\n          xtoken:'',\n          msg: '',\n          error: '',\n          downloadFile:true,\n          data: [],\n        };\n        this.csvFileInput = React.createRef();\n        AsyncStorage.getItem(conf.secret)\n        .then((results) => {\n          if( results !== null )\n          {\n            let obje_results = JSON.parse(results);\n            this.setState({\n              ...this.state,\n              xtoken : obje_results.user.token,\n            });\n            findTrucks(obje_results.user.token).then((response) => {\n                this.setState({\n                    ...this.state,\n                    data:response.data,\n                });\n            }).catch((respError) => {});\n          }\n        })\n        .catch((error) => {\n          console.log('storage error', error);\n        });\n    }\n    componentDidMount() {\n    }\n\n    rerenderParentCallback = () => {\n      findTrucks(this.state.xtoken).then((response) => {\n        this.setState({\n            ...this.state,\n            data:response.data,\n        });\n      }).catch((respError) => {\n      });\n    }\n    \n    handleFileInput = (event) => {\n        const v = event.target.files[0];\n        this.setState({...this.state, file: v,});\n    }\n    handleSaveChanges = () => {\n        const formData = new FormData();\n        formData.append('csv', this.state.file);\n        importTrucks(this.state.xtoken, formData)\n        .then((response) => {\n            if( response.status === 200)\n            {\n                this.setState({\n                    ...this.state,\n                    file : '',\n                    msg: response.message,\n                    data: response.data,\n                    error: '',\n                });\n                this.forceUpdate();\n            }\n            else\n            {\n                this.setState({\n                    ...this.state,\n                    error: response.message,\n                    msg: '',\n                });\n            }\n        })\n        .catch((error) => {\n            this.setState({\n                ...this.state,\n                error: 'Connection error occured',\n            });\n            console.log('error', error);\n        });\n    }\n    render() {\n        const columns = [\n            {\n              name: 'Id',\n              options: {\n                display: false\n              }\n            },\n            {\n              name: 'Oid',\n              options: {\n                display: false\n              }\n            },\n            'Truck No.',\n            'Truck Owner',\n            'Truck Make',\n            'Truck VIN',\n        ];\n\n        const data2 = () => {\n          let rtn = [];\n          this.state.data.map(item => {\n            rtn.push([\n              item.id,\n              item.owner,\n              item.number,\n              item.company,\n              item.make,\n              item.vin,\n            ]);\n          });\n          return rtn;\n        }\n      \n        const options = {\n            filter: true,\n            selectableRows: 'single',\n            selectableRowsOnClick:true,\n            filterType: 'dropdown',\n            responsive: 'vertical',\n            draggableColumns: {\n              enabled: true\n            },\n            rowsPerPage: 5,\n            selectToolbarPlacement: 'replace',\n            customToolbarSelect: (selectedRows, displayData, setSelectedRows) => (\n              <CustomToolbarSelectTrucks rerenderParentCallback={this.rerenderParentCallback} selectedRows={selectedRows} displayData={displayData} setSelectedRows={setSelectedRows}  originalData={this.state.data} Xtoken={this.state.xtoken}/>\n            ),\n            downloadOptions: {\n                filename: 'trucks-excel-format.csv',\n                separator: ';',\n                filterOptions: {\n                  useDisplayedColumnsOnly: true,\n                  useDisplayedRowsOnly: true,\n                }\n            },\n            onDownload: (buildHead, buildBody, columns, data2) => {\n              if (this.state.downloadFile) {\n                let val= `${buildHead(columns)}${buildBody(data2)}`.trim();\n                return val;\n              }\n      \n              return false;\n            },\n            onRowSelectionChange: (currentRowsSelected, allRows, rowsSelected) => {\n              // console.log('currentRowsSelected', currentRowsSelected);\n            },\n            onRowsDelete: rowsDeleted => {\n              // console.log(rowsDeleted, 'were deleted!');\n            },\n            onChangePage: numberRows => {\n              // console.log(numberRows);\n            },\n            onSearchChange: searchText => {\n              // console.log(searchText);\n            },\n            onColumnSortChange: (column, direction) => {\n              // console.log(column, direction);\n            },\n            onViewColumnsChange: (column, action) => {\n              // console.log(column, action);\n            },\n            onFilterChange: (column, filters) => {\n              // console.log(column, filters);\n            },\n            onCellClick: (cellIndex, rowIndex) => {\n              // console.log(cellIndex, rowIndex);\n            },\n            onRowClick: (rowData, rowState) => {\n              // console.log(rowData, rowState);\n            },\n        };\n      return (\n        <Page title=\"Import trucks\" breadcrumbs={[{ name: 'Import', active: true }]}>\n          <Row>\n            <Col xl={12} lg={12} md={12}>\n              <Card>\n                <CardHeader>Import Trucks</CardHeader>\n                {this.state.error.length > 0 && (\n                    <Alert color=\"danger\">{this.state.error}</Alert>\n                )}\n                {this.state.msg.length > 0 && (\n                    <Alert color=\"success\">{this.state.msg}</Alert>\n                )}\n              </Card>\n            </Col>\n          </Row>\n\n          <Row>\n            <Col xl={12} lg={12} md={12}>\n              <Card>\n                <CardBody>\n                  <Form>\n                  <FormGroup>\n                    <Label for=\"exampleFile\">Upload CSV file</Label>\n                    <Input ref={this.csvFileInput} onChange={this.handleFileInput} type=\"file\" name=\"file\" />\n                    <FormText color=\"muted\">\n                      Upload a CSV file to import trucks. Make sure the file is a valid CSV with <b>number,owner,make,vin</b> as column headers.\n                    </FormText>\n                  </FormGroup>\n                  <FormGroup check row>\n                      <Col sm={{ size: 10, offset: 2 }}>\n                        <Button type=\"button\" onClick={this.handleSaveChanges}>Import trucks</Button>\n                      </Col>\n                    </FormGroup>\n                  </Form>\n                </CardBody>\n              </Card>\n            </Col>            \n          </Row>\n\n          <Row>\n            <Col xl={12} lg={12} md={12}>\n              <Card>\n                <CardBody>\n                    <MUIDataTable title={'Trucks'}\n                    data={this.state.data.map(item => {\n                      return [\n                        item.id,\n                        item.owner,\n                        item.number,\n                        item.company,\n                        item.make,\n                        item.vin,\n                      ]\n                    })} columns={columns} options={options} />\n                </CardBody>\n              </Card>\n            </Col>\n          </Row>\n    \n        </Page>\n      );\n    }\n}\nexport default ImportTrucksPage;\n"],"sourceRoot":""}